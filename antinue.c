/*
	 antinue.c

		Parameter calculation for electron anti neutrinos

		$Source: /home/nkarlsson/usr/cvsroot/cparamlib/Attic/antinue.c,v $
		$Author: niklas $ $Date: 2006/02/02 16:33:43 $ $Revision: 1.2 $
*/

#include <stdio.h>
#include <math.h>
#include "cparammodel.h"

/*
		Calculate parameters for electron anti neutrino from non-diff
*/
void antinue_param_nd(double Pp, double* a) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that a0 and a4 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							0.0445831045508 0.185184702277 -0.0252182129771 0.00295956782065
							-4.78325864606e-06 4.58372342109e-05 0.429796010256 6.15593944531e-06 4.17305612564 1.19282742617e-06
							-245.224960327 73.2229919434 -19.6516265869 0.83138012886 0.715635001659
							0.452317714691 0.529340386391 0.0100781433284 -0.00170923187397
							0.0468848235905 0.189335510135 0.0211527608335 -0.0209385622293 0.00256953551434
							4.76732493553e-05 5.49357937416e-05 0.00679045822471 0.000207401491934 4.97721815109
							-270.300567627 -114.466438293 0.34352183342 80.0849914551 -7.92403793335
							3271.85229492 -291610.125 87.8467941284 -6.23296308517
							-0.177871257067 0.367711722851 -0.0253971107304 0.0019238491077 0.00327251874842

    f5 = P[5,1] + P[5,2]*log10(P[5,3]*(x + 4.3)) + P[5,4]/(x + P[5,5])
    f6 = P[6,1] + P[6,2]*log10(P[6,3]*(x + 3.4)) + P[6,4]*x + P[6,5]*x**2
    f7 = P[7,1] + P[7,2]/(x + P[7,3]) + P[7,4]*x**2
    f8 = P[8,1] + P[8,2]*x + P[8,3]*x**2 + P[8,4]*x**3 + P[8,5]*x**4
				*/
				if (Tp > 0.4) {
								a[0] = 0.0013113 + 0.36538*(y + 3.31) + 1.5178*pow(y + 3.31, 2) - 0.20668*pow(y + 3.31, 3) + 0.024255*pow(y + 3.31, 4);
								a[1] = -4.7833e-6 + 4.5837e-5*exp(-0.42980*(y + 3.4)) + 6.1559e-6/(y + 4.1731) + 1.1928e-6*y;
								a[2] = -245.22 + 73.223*y - 19.652*y*y + 0.83138*y*y*y + 0.71564*y*y*y*y;
								a[3] = 0.45232 + 0.52934*y + 0.010078*y*y - 0.0017092*y*y*y;
								a[4] = -0.0025734 + 0.38424*(y + 3.32) + 1.5517*pow(y + 3.32, 2) + 0.17336*pow(y + 3.32, 3) - 0.17160*pow(y + 3.32, 4) + 0.021059*pow(y + 3.32, 5);
								a[5] = 4.7673e-5 + 5.4936e-5*log10(0.0067905*(y + 4.3)) + 0.00020740/(y + 4.9772);
								a[6] = -270.30 - 114.47*log10(0.34352*(y + 3.4)) + 80.085*y - 7.9240*y*y;
								a[7] = 3271.9 - 2.9161e5/(y + 87.847) - 6.2330*y*y;
								a[8] = -0.17787 + 0.36771*y + 0.025397*y*y - 0.0019238*y*y*y + 0.0032725*y*y*y*y;
				} else {
								for (i = 0; i < 9; i++)
												a[i] = 0.0;
				}
}

/*
		Calculate parameters for electron anti neutrino from diff. dissoc.
*/
void antinue_param_diff(double Pp, double* b) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that b0 and b4 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							6.56574440002 -0.41421481967 -0.824090242386 0.760103940964 0.00107473961543 8.50751304626
							-50.2114830017 55.1305122375 1.36511218548 -1.89007282257 4.4440279007
							-17.2311382294 0.0411003828049 7.96380329132 -0.055448975414 0.000258658459643 250.676300049
							12.3346376419 12.8934230804 1.44123768806 -1.89979159832 5.59691333771
							0.165438100696 0.0568620748818 0.00646432023495 0.0970960706472 5.4006652832 4.61206817627
							1.87563610077 -0.421693772078 1.60995006561 -0.0510257780552 -3.95732331276
							1.50159013271 1.01184630394 -0.0727867931128 -0.00388579512946 0.00936496071517
							4.97351932526 5.5673789978 -0.362489521503 -0.206590548158 -2.86044001579
				*/

				if (Tp > 1.38) {
								if (Tp > 11.0) {
												b[0] = 53.809*tanh(-0.41421*(y + 2.2)) - 6.7538*pow(y + 0.76010, 2) + 0.0088080*pow(y + 8.5075, 4);
												b[1] = -50.211 + 55.131*exp(-1.3651*pow((y + 1.8901)/(1.0 + 4.4440*(y + 1.8901)), 2));
												b[2] = -17.231 + 0.041100*tanh(7.9638*(y + 1.9)) - 0.055449*y + 0.00025866*pow(y + 250.68, 2);
												b[3] = 12.335 - 12.893*exp(-1.4412*pow((y + 1.8998)/(1.0 + 5.5969*(y + 1.8998)), 2));
								} else {
												b[0] = 0.0;
												b[1] = 0.0;
												b[2] = 0.0;
												b[3] = 0.0;
								}
								b[4] = 1.3558 + 0.46601*(y + 2.95) + 0.052978*pow(y + 2.95, 2) + 0.79575*exp(-5.4007*pow(y + 2.2 + 4.6121*pow(y + 2.2, 2), 2));
								b[5] = 1.8756 - 0.42169*tanh(1.6100*(y + 1.9)) - 0.051026*(y - 3.9573);
								b[6] = 1.5016 + 1.0118*y - 0.072787*y*y - 0.0038858*y*y*y + 0.0093650*y*y*y*y;
								b[7] = 4.9735 + 5.5674*tanh(-0.36249*(y + 2.1)) - 0.20660*pow(y - 2.8604, 2);
				} else {
								for (i = 0; i < 8; i++)
												b[i] = 0.0;
				}
}

/*
		Calculate parameters for electron anti neutrino from delta(1232)
*/
void antinue_param_delta(double Pp, double* c) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that d0 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							0.345188081264 71.3389663696 -3.12816596031 0.484202444553 1.17551243305 1.9197384119 -0.063953384757
							-24.5709648132 -15.8305931091 -2.11997485161
							-5.95927524567 -6.46954679489 4.72247743607 0.500029683113
							0.260222762823 0.245451554656
							0.0764977037907 0.0616779774427 0.00400281930342
				*/

    if (Tp <= 0.4 || Tp >= 2.0) {
								for (i = 0; i < 5; i++)
												c[i] = 0.0;
				} else {
								c[0] = 2.8290*exp(-71.339*pow(((y + 3.1282)/(1.0 + 0.48420*(y + 3.1282))), 2)) - (9.6339 + 15.733/y - 0.52413*y*y);
								c[1] = -24.571 - 15.831*y - 2.1200*y*y;
								c[2] = -5.9593 - 6.4695*tanh(4.7225*(y + 2.1)) + 0.50003*y;
								c[3] = 0.26022 + 0.24545*y;
								c[4] = 0.076498 + 0.061678*y + 0.0040028*y*y;
				}
}

/*
		Calculate parameters for electron anti neutrino from res(1600)
*/
void antinue_param_res(double Pp, double* d) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that d0 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							0.219036802649 57.2595100403 -2.95092368126 1.41012072563 0.0715071186423 0.0291233528405
							-2.63954329491 -1.51046860218 0.22173550725
							-7.05120277405 -7.19699287415 31.073923111 0.390072196722
							-1.42706537247 -1.03994941711 -0.241785287857
							0.748775780201 0.636164546013 0.17395567894 0.0176361650229
				*/

    if (Tp <= 0.6 || Tp >= 2.9) {
								for (i = 0; i < 5; i++)
												d[i] = 0.0;
				} else {
								d[0] = 1.7951*exp(-57.260*pow((y + 2.9509)/(1.0 + 1.4101*(y + 2.9509)), 2)) - (0.58604 + 0.23868*y);
								d[1] = -2.6395 - 1.5105*y + 0.22174*y*y;
								d[2] = -7.0512 - 7.1970*tanh(31.074*(y + 2.1)) + 0.39007*y;
								d[3] = -1.4271 - 1.0399*y - 0.24179*y*y;
								d[4] = 0.74875 + 0.63616*y + 0.17396*y*y + 0.017636*y*y*y;
				}
}
