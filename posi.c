/*
	 posi.c

		Parameter calculation for positrons

		$Source: /home/nkarlsson/usr/cvsroot/cparamlib/Attic/posi.c,v $
		$Author: niklas $ $Date: 2006/01/28 21:37:36 $ $Revision: 1.1 $
*/

#include <stdio.h>
#include <math.h>
#include "cparammodel.h"

/*
		Calculate parameters for positron from non-diff
*/
void posi_param_nd(double Pp, double* a) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that a0 and a4 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							-0.0971335172653 0.945592820644 -0.479853034019 0.0978613495827 -0.00671031558886
							6.79428057992e-06 -3.5344708067e-06 6.09270273344e-07 2.02188431331e-07 5.10053581593e-08 -4.26223110139e-08
							44.8273010254 81.3782653809 0.027733316645 -13885.9570312 8.44171237946
							0.520102679729 0.593361794949 0.0120323887095 -0.00642422027886
							0.260641157627 0.225898891687 -0.0584131404757 0.000390978035284 0.00101220363285
							1.08451126835e-06 1.43362171912e-06 0.00772554660216 0.000130176325911 4.81884002686 9.36013933028e-08
							-267.736297607 14.1750164032 0.353914827108 64.6693954468 -7.70355606079
							138.260513306 -529.838012695 0.124669328332 -19869.2695312 7.68836832047 1.06751298904
							-0.147067934275 0.40135461092 0.00398988928646 -0.00166020612232
				*/
				if (Tp > 0.4) {
								a[0] = -0.79606*(y + 3.3) + 7.7496*pow(y + 3.3, 2) - 3.9326*pow(y + 3.3, 3) + 0.80202*pow(y + 3.3, 4) - 0.054994*pow(y + 3.3, 5);
								a[1] = 6.7943e-6 - 3.5345e-6*y + 6.0927e-7*y*y + 2.0219e-7*y*y*y + 5.1005e-8*y*y*y*y - 4.2622e-8*y*y*y*y*y;
								a[2] = 44.827 + 81.378*log10(0.027733*(y + 3.5)) - 1.3886e4/pow(y + 8.4417, 2);
								a[3] = 0.52010 + 0.59336*y + 0.012032*y*y - 0.0064242*y*y*y;
								a[4] = 2.1361*(y + 3.32) + 1.8514*pow(y + 3.32, 2) - 0.47572*pow(y + 3.32, 3) + 0.0032043*pow(y + 3.32, 4) + 0.0082955*pow(y + 3.32, 5);
								a[5] = 1.0845e-6 + 1.4336e-6*log10(0.0077255*(y + 4.3)) + 0.00013018/pow(y + 4.8188, 2) + 9.3601e-8*y;
								a[6] = -267.74 + 14.175*log10(0.35391*(y + 3.4)) + 64.669*y - 7.7036*y*y;
								a[7] = 138.26 - 529.84*log10(0.12467*(y + 3.9)) - 1.9869e4/pow(y + 7.6884, 2) + 1.0675*y*y;
								a[8] = -0.14707 + 0.40135*y + 0.0039899*y*y - 0.0016602*y*y*y;
				} else {
								for (i = 0; i < 9; i++)
												a[i] = 0.0;
				}
}

/*
		Calculate parameters for positron from diff. dissoc.
*/
void posi_param_diff(double Pp, double* b) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that b0 and b4 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							3.56192159653 -0.378794789314 -0.392854571342 0.675004661083 0.00044765509665 9.08243083954
							-142.96635437 147.8568573 0.371939599514 -1.87809276581 3.83885550499
							-14.4874792099 -4.22232198715 -13.5457267761 0.000169882376213 234.647613525
							-0.00369744631462 0.41975620389 6.15271615982 -1.81937229633 0.999455809593
							0.220948114991 0.0226288419217 -0.000244634633418 0.103818245232 14.9871606827 -0.189670920372
							2.0403752327 -0.515474557877 2.27578520775 -0.0350058339536 -6.65551614761
							1.52579438686 1.01315379143 -0.0643878951669 -0.0040208962746 0.00837717577815
							3.05505847931 3.5239880085 -0.367388755083 -0.133813351393 -2.77184319496
				*/

				if (Tp > 1.38) {
								if (Tp > 11.0) {
												b[0] = 29.192*tanh(-0.37879*(y + 2.2)) - 3.2196*pow(y + 0.67500, 2) + 3.6687e-3*pow(y + 9.0824, 4);
												b[1] = -142.97 + 147.86*exp(-0.37194*pow((y + 1.8781)/(1.0 + 3.8389*(y + 1.8781)), 2));
												b[2] = -14.487 - 4.2223*tanh(-13.546*(y + 2.2)) + 0.00016988*pow(y + 234.65, 2);
												b[3] = -0.0036974 - 0.41976*exp(-6.1527*pow((y + 1.8194)/(1.0 + 0.99946*(y + 1.8194)), 2));
								} else {
												b[0] = 0.0;
												b[1] = 0.0;
												b[2] = 0.0;
												b[3] = 0.0;
								}
								b[4] = 1.8108 + 0.18545*pow(y + 2.95, 2) - 2.0049e-3*pow(y + 2.95, 4) + 0.85084*exp(-14.987*pow(y + 2.29 - 0.18967*(y + 2.29), 2));
								b[5] = 2.0404 - 0.51548*tanh(2.2758*(y + 1.9)) - 0.035009*(y - 6.6555);
								b[6] = 1.5258 + 1.0132*y - 0.064388*y*y - 0.0040209*y*y*y + 0.0082772*y*y*y*y;
								b[7] = 3.0551 + 3.5240*tanh(-0.36739*(y + 2.1)) - 0.13382*pow(y - 2.7718, 2);
				} else {
								for (i = 0; i < 8; i++)
												b[i] = 0.0;
				}
}

/*
		Calculate parameters for positron from delta(1232)
*/
void posi_param_delta(double Pp, double* c) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that c0 have been multiplied with 1/(10^0.05 - 1) for unit conversion
				*/

    if (Tp <= 0.4 || Tp >= 2.0)
								for (i = 0; i < 5; i++)
												c[i] = 0.0;
				else {
								c[0] = 0.0;
								c[1] = 0.0;
								c[2] = 0.0;
								c[3] = 0.0;
								c[4] = 0.0;
				}
}

/*
		Calculate parameters for gamma-ray from res(1600)
*/
void posi_param_res(double Pp, double* d) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that d0 have been multiplied with 1/(10^0.05 - 1) for unit conversion
				*/

    if (Tp <= 0.6 || Tp >= 2.9) {
								for (i = 0; i < 5; i++)
												d[i] = 0.0;
				} else {
								d[0] = 0.0;
								d[1] = 0.0;
								d[2] = 0.0;
								d[3] = 0.0;
								d[4] = 0.0;
				}
}
