/*
	 antinumu.c

		Parameter calculation for muon anti neutrinos

		$Source: /home/nkarlsson/usr/cvsroot/cparamlib/Attic/antinumu.c,v $
		$Author: niklas $ $Date: 2006/02/02 21:53:22 $ $Revision: 1.1 $
*/

#include <stdio.h>
#include <math.h>
#include "cparammodel.h"

/*
		Calculate parameters for muon anti neutrino from non-diff
*/
void antinumu_param_nd(double Pp, double* a) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that a0 and a4 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							-0.185991585255 1.23324215412 -0.526211738586 0.0977133139968 -0.00594520336017
							-2.62967587332e-05 9.38576922636e-05 0.323838979006 7.78205503593e-06 4.05602025986 7.61485125622e-06 -8.40908967348e-07
							-243.62197876 59.3739776611 -5.73555803299 1.98147809505 -1.04779481888
							0.508068501949 0.602210879326 0.00341200479306 -0.0111390100792
							0.323135674 0.544017136097 -0.155495405197 0.0142262140289 0.000371871079551
							9.11014865324e-07 1.38803295613e-06 0.0169981326908 0.000125834150822 4.77067899704
							-272.112670898 53.4774284363 0.355306923389 56.0406951904 -6.08761930466
							6431.83984375 893.920410156 5.70126656996e-09 2103.59521484 5.6739859581 -6.1124920845
							-0.111196398735 0.381441265345 -0.0401276387274 0.00474844034761 0.00547071173787
				*/
				if (Tp > 0.4) {
								a[0] = -1.5243*(y + 3.3) + 10.107*pow(y + 3.3, 2) - 4.3126*pow(y + 3.3, 3) + 0.80081*pow(y + 3.3, 4) - 0.048724*pow(y + 3.3, 5);
								a[1] = -2.6297e-5 + 9.3858e-5*exp(-0.32384*(y + 3.4)) + 7.7821e-6/(y + 4.0560) + 7.6149e-6*y - 8.4091e-7*y*y;
								a[2] = -243.62 + 59.374*y - 5.7356*y*y + 1.9815*y*y*y - 1.0478*y*y*y*y;
								a[3] = 0.50807 + 0.60221*y + 0.0034120*y*y - 0.011139*y*y*y;
								a[4] = 2.6483*(y + 3.32) + 4.4585*pow(y + 3.32, 2) - 1.2744*pow(y + 3.32, 3) + 0.11659*pow(y + 3.32, 4) + 0.0030477*pow(y + 3.32, 5);
								a[5] = 9.1101e-7 + 1.3880e-6*log10(0.016998*(y + 4.3)) + 0.00012583/pow(y + 4.7707, 2);
								a[6] = -272.11 + 53.477*log10(0.35531*(y + 3.4)) + 56.041*y - 6.0876*y*y;
								a[7] = 6431.8 + 893.92*log10(5.7013e-9*(y + 3.9)) + 2103.6/(y + 5.6740) - 6.1125*y*y;
								a[8] = -0.11120 + 0.38144*y - 0.040128*y*y + 0.0047484*y*y*y + 0.0054707*y*y*y*y;
				} else {
								for (i = 0; i < 9; i++)
												a[i] = 0.0;
				}
}

/*
		Calculate parameters for muon anti neutrino from diff. dissoc.
*/
void antinumu_param_diff(double Pp, double* b) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that b0 and b4 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							5.04022836685 -0.374111622572 -0.502991974354 0.555054187775 0.00052043038886 9.26850318909
							-132.497528076 142.121444702 8.02891921997 -1.91964447498 11.5301580429
							-17.2226715088 0.0112848961726 69.7463684082 -0.0482330694795 0.000258806801867 250.765533447
							8.19913768768 9.64370822906 45.2611694336 -1.92924618721 16.6818733215
							0.0682312548161 0.0447165779769 0.00685667200014 0.0609562620521 5.53165960312 0.438668340445
							1.25439107418 -0.523622095585 2.76376008987 -0.0558370649815 -17.6376686096
							1.4788351059 1.02780652046 -0.0928517282009 -0.00627340003848 0.0119195589796
							5.16509532928 5.73983097076 -0.373560637236 -0.222342729568 -2.78893399239
				*/

				if (Tp > 1.38) {
								if (Tp > 11.0) {
												b[0] = 41.307*tanh(-0.37411*(y + 2.2)) - 4.1223*pow(y + 0.55505, 2) + 0.0042652*pow(y + 9.2685, 4);
												b[1] = -132.50 + 142.12*exp(-8.0289*pow((y + 1.9196)/(1.0 + 11.530*(y + 1.9196)), 2));
												b[2] = -17.223 + 0.011285*tanh(69.746*(y + 1.9)) - 0.048233*y + 0.00025881*pow(y + 250.77, 2);
												b[3] = 8.1991 - 9.6437*exp(-45.261*pow((y + 1.9292)/(1.0 + 16.682*(y + 1.9292)), 2));
								} else {
												b[0] = 0.0;
												b[1] = 0.0;
												b[2] = 0.0;
												b[3] = 0.0;
								}
								b[4] = 0.55919 + 0.36647*(y + 2.95) + 0.056194*pow(y + 2.95, 2) + 0.49957*exp(-5.5317*pow(y + 2.2 + 0.43867*pow(y + 2.2, 2), 2));
								b[5] = 1.2544 - 0.52362*tanh(2.7638*(y + 1.9)) - 0.055837*(y - 17.638);
								b[6] = 1.4788 + 1.0278*y - 0.092852*y*y - 0.0062734*y*y*y + 0.011920*y*y*y*y;
								b[7] = 5.1651 + 5.7398*tanh(-0.37356*(y + 2.1)) - 0.22234*pow(y - 2.7889, 2);
				} else {
								for (i = 0; i < 8; i++)
												b[i] = 0.0;
				}
}

/*
		Calculate parameters for muon anti neutrino from delta(1232)
*/
void antinumu_param_delta(double Pp, double* c) {
				c[0] = c[1] = c[2] = c[3] = c[4] = 0.0;
}

/*
		Calculate parameters for muon anti neutrino from res(1600)
*/
void antinumu_param_res(double Pp, double* d) {
    double Etot, Tp, y;
				int i;

				Etot	= sqrt(Pp*Pp + m_p*m_p);
    Tp = Etot - m_p;
    y = log10(Tp*0.001);

				/* These are the original parameter values
							note that d0 have been multiplied with 1/(10^0.05 - 1) for unit conversion
							0.0444865971804 58.2102165222 -2.95368266106 1.43199265003 0.0137672061101 0.00564260641113
							-9.50664615631 -5.46553182602 -0.317691653967
							-7.18312692642 -7.15508651733 30.3540401459 0.337569147348
							2.79380726814 1.6991943121 0.201611116529
							0.618783593178 0.623712420464 0.189134046435 0.0191184338182
				*/

    if (Tp <= 0.6 || Tp >= 2.9) {
								for (i = 0; i < 5; i++)
												d[i] = 0.0;
				} else {
								d[0] = 0.36459*exp(-58.210*pow((y + 2.9537)/(1.0 + 1.4320*(y + 2.9537)), 2)) - (0.11283 + 0.046244*y);
								d[1] = -9.5066 - 5.4655*y - 0.31769*y*y;
								d[2] = -7.1831 - 7.1551*tanh(30.354*(y + 2.1)) + 0.33757*y;
								d[3] = 2.7938 + 1.6992*y + 0.20161*y*y;
								d[4] = 0.61878 + 0.62371*y + 0.18913*y*y + 0.019118*y*y*y;
				}
}
